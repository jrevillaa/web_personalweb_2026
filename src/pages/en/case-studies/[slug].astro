---
import { getCollection } from 'astro:content';
import BaseLayout from '../../../components/layout/BaseLayout.astro';

export async function getStaticPaths() {
  const allCases = await getCollection('case-studies');
  const enCases = allCases.filter(post => post.data.lang === 'en');
  
  return enCases.map(post => ({
    params: { slug: post.slug.replace(/-en$/, '') },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<BaseLayout title={`${post.data.title} | Jair Revilla`} description={post.data.description} lang="en">
  <main class="container">
    <article class="case-detail">
      <header class="case-header">
        <div class="meta">
            <span class="date">{post.data.date.toLocaleDateString('en-US', { year: 'numeric', month: 'long' })}</span>
            {post.data.client && <span class="client">Client: {post.data.client}</span>}
        </div>
        <h1 class="case-title">{post.data.title}</h1>
        <div class="tags">
            {post.data.tags.map(tag => <span class="tag">{tag}</span>)}
        </div>
      </header>

      <div class="case-content">
        <Content />
      </div>
    </article>
  </main>
</BaseLayout>

<style>
  .case-detail {
    max-width: 800px;
    margin: 0 auto;
    padding: var(--space-8) 0;
  }

  .case-header {
    margin-bottom: var(--space-8);
    text-align: center;
    border-bottom: 1px solid #eee;
    padding-bottom: var(--space-8);
  }

  .meta {
    font-size: 0.9rem;
    color: #666;
    margin-bottom: var(--space-2);
    display: flex;
    justify-content: center;
    gap: var(--space-4);
  }

  .case-title {
    font-size: 2.5rem;
    margin-bottom: var(--space-4);
    color: #1a1a1a;
  }

  .tags {
    display: flex;
    justify-content: center;
    gap: var(--space-2);
  }

  .tag {
    background: #f0f0f0;
    padding: 2px 10px;
    border-radius: 20px;
    font-size: 0.85rem;
    color: #444;
  }

  /* Typography for Markdown Content */
  .case-content {
    line-height: 1.8;
    font-size: 1.1rem;
    color: #333;
  }

  .case-content :global(h2) {
    font-size: 1.8rem;
    margin-top: var(--space-8);
    margin-bottom: var(--space-4);
    color: #1a1a1a;
  }

  .case-content :global(ul) {
    padding-left: var(--space-6);
    margin-bottom: var(--space-4);
  }

  .case-content :global(li) {
    margin-bottom: var(--space-2);
  }
  
  .case-content :global(strong) {
    color: #000;
    font-weight: 700;
  }
</style>
